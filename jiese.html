<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8"/>
<title>戒邪淫自评问卷</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
 body{font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;margin:0;padding:0;background:#f7f9fc;color:#333}
 .container{max-width:720px;margin:40px auto;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.08)}
 h1{text-align:center;color:#d9534f;margin-bottom:10px}
 .sub{line-height:1.6;text-align:center;color:#666;margin-bottom:30px}
 .section{margin-bottom:30px}
 .section h2{font-size:18px;border-left:4px solid #d9534f;padding-left:8px;margin:0 0 15px}
 label{display:block;margin:8px 0;line-height:1.5}
 input[type=radio],input[type=checkbox]{margin-right:6px;transform:scale(1.15)}
 textarea{width:100%;min-height:60px;padding:8px;border:1px solid #ccc;border-radius:4px;resize:vertical;font-size:14px}
 .required{color:#d9534f}
 .btn{background:#d9534f;color:#fff;border:0;padding:12px 32px;font-size:16px;border-radius:4px;cursor:pointer;display:block;margin:30px auto}
 .btn:hover{background:#c9302c}
</style>
</head>
<body>
<div class="container">
  <h1>戒邪淫自评问卷</h1>
  <p class="sub">所有题目仅用于自我反省与改进，绝不外传。完成后请按提示将结果文件发回给发起者。</p>

  <form id="surveyForm" onsubmit="return false">
    <!-- 基本信息 -->
    <div class="section">
      <h2>1. 基本信息（匿名）</h2>
      <label>年龄段：
        <select name="age" required>
          <option value="">请选择</option>
          <option value="12-15">12-15岁</option>
          <option value="16-18">16-18岁</option>
          <option value="19-25">19-25岁</option>
          <option value="26-35">26-35岁</option>
          <option value="36-45">36-45岁</option>
          <option value="46+">46岁以上</option>
        </select>
      </label>

      <label>性别：
        <input type="radio" name="gender" value="男" required>男
        <input type="radio" name="gender" value="女">女
      </label>

      <label>受教育程度：
        <select name="edu" required>
          <option value="">请选择</option>
          <option value="小学">小学</option>
          <option value="初中">初中</option>
          <option value="高中/中专">高中/中专</option>
          <option value="大专">大专</option>
          <option value="本科">本科</option>
          <option value="研究生及以上">研究生及以上</option>
        </select>
      </label>
    </div>

    <!-- 行为频率 -->
    <div class="section">
      <h2>2. 行为频率（单选）<span class="required">*</span></h2>
      <p>近3个月，以下行为平均多久发生一次？</p>
      <label><input type="radio" name="freq_porn" value="0">从未</label>
      <label><input type="radio" name="freq_porn" value="1">每月≤1次</label>
      <label><input type="radio" name="freq_porn" value="2">每月2-4次</label>
      <label><input type="radio" name="freq_porn" value="3">每周1-2次</label>
      <label><input type="radio" name="freq_porn" value="4">每周≥3次</label>
      <label><input type="radio" name="freq_porn" value="5">几乎每天</label>
    </div>

    <div class="section">
      <h2>3. 依赖程度（单选）<span class="required">*</span></h2>
      <p>你是否觉得无法控制或停止观看/意淫？</p>
      <label><input type="radio" name="addict" value="0">完全可控</label>
      <label><input type="radio" name="addict" value="1">偶尔失控</label>
      <label><input type="radio" name="addict" value="2">经常失控</label>
      <label><input type="radio" name="addict" value="3">完全失控</label>
    </div>

    <!-- 触发场景 -->
    <div class="section">
      <h2>4. 触发场景（可多选）</h2>
      <label><input type="checkbox" name="trigger" value="手机">手机/短视频</label>
      <label><input type="checkbox" name="trigger" value="电脑">电脑/网站</label>
      <label><input type="checkbox" name="trigger" value="独处">独处/睡前</label>
      <label><input type="checkbox" name="trigger" value="压力">学业/工作压力</label>
      <label><input type="checkbox" name="trigger" value="情绪">孤独/焦虑/无聊</label>
      <label><input type="checkbox" name="trigger" value="其他">其他：<input type="text" name="trigger_other" placeholder="请填写"></label>
    </div>

    <!-- 后果评估 -->
    <div class="section">
      <h2>5. 后果评估（单选）</h2>
      <p>邪淫行为是否已对你的以下方面造成明显困扰？（可多选）</p>
      <label><input type="checkbox" name="impact" value="学业">学业/工作</label>
      <label><input type="checkbox" name="impact" value="人际">人际关系</label>
      <label><input type="checkbox" name="impact" value="健康">身体健康</label>
      <label><input type="checkbox" name="impact" value="精神">精神状态/焦虑抑郁</label>
      <label><input type="checkbox" name="impact" value="经济">经济（打赏、借贷）</label>
    </div>

    <!-- 已采取措施 -->
    <div class="section">
      <h2>6. 已采取过的戒除措施（可多选）</h2>
      <label><input type="checkbox" name="method" value="运动">运动/健身</label>
      <label><input type="checkbox" name="method" value="阅读">阅读/学习</label>
      <label><input type="checkbox" name="method" value="冷水">冷水洗脸/淋浴</label>
      <label><input type="checkbox" name="method" value="软件">安装屏蔽软件</label>
      <label><input type="checkbox" name="method" value="倾诉">向他人倾诉</label>
      <label><input type="checkbox" name="method" value="宗教">宗教/信仰</label>
      <label><input type="checkbox" name="method" value="就医">心理咨询/就医</label>
      <label><input type="checkbox" name="method" value="无">尚未采取任何措施</label>
    </div>

    <!-- 自我评分 -->
    <div class="section">
      <h2>7. 自我评分（单选）<span class="required">*</span></h2>
      <p>如果 0 为“毫无困扰”，10 为“极度困扰”，你给自己目前打几分？</p>
      <label>评分：<input type="range" name="score" min="0" max="10" value="5" oninput="this.nextElementSibling.value=this.value"><output>5</output>/10</label>
    </div>

    <!-- 开放题 -->
    <div class="section">
      <h2>8. 开放题（选填）</h2>
      <label>写下你对戒邪淫最大的困惑或最想对自己说的一句话：<br>
        <textarea name="open" placeholder="在此输入..."></textarea>
      </label>
    </div>

    <button class="btn" type="submit">提交问卷并下载结果</button>
  </form>
</div>

<script>
/* 收集表单数据并触发下载 */
document.getElementById('surveyForm').addEventListener('submit', function (e) {
  e.preventDefault();

  /* 必填校验 */
  const required = ['age', 'gender', 'edu', 'freq_porn', 'addict', 'score'];
  for (let name of required) {
    const val = this.querySelector(`[name="${name}"]:checked, [name="${name}"]`).value;
    if (!val) { alert('请完整回答带 * 的题目'); return; }
  }

  /* 汇总数据 */
  const data = {};
  const form = new FormData(this);
  for (let [k, v] of form.entries()) {
    if (data[k]) {          // 多选合并
      data[k] = [].concat(data[k], v);
    } else {
      data[k] = v;
    }
  }

  /* 生成文件并下载 */
  const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `survey_${new Date().toISOString().slice(0,19).replace(/[-:]/g,'')}.json`;
  a.click();
  URL.revokeObjectURL(url);

  /* 提示回传 */
  alert('已生成结果文件，请将该文件发送给问卷发起者（微信/邮件/QQ均可）。感谢配合！');
});
</script>
</body>
</html>
